<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>{{ page.title }} | {{ site.title }}</title>
        <link
            rel="stylesheet"
            href="{{ '/assets/css/tailwind.output.css' | relative_url }}"
        />
        <link
            href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&family=Noto+Sans+KR:wght@400;500;700&display=swap"
            rel="stylesheet"
        />
        <style>
            .series-filter.active {
                background-color: rgba(244, 114, 182, 0.9);
                border-color: rgba(244, 114, 182, 0.9);
                color: #fff;
            }
            .mermaid-diagram-shell {
                border-radius: 1.5rem;
                background: linear-gradient(145deg, rgba(255, 241, 242, 0.8), rgba(255, 255, 255, 0.9));
                border: 1px solid rgba(248, 113, 113, 0.2);
                box-shadow: 0 20px 50px rgba(15, 23, 42, 0.08);
                padding: 1.5rem;
            }
            .mermaid {
                font-family: 'Poppins', 'Noto Sans KR', sans-serif;
            }
        </style>
    </head>
    {% assign background_image = page.body_background | default: '/assets/images/home/background.png' %}
    <body
        class="min-h-screen bg-white/95 text-slate-900 antialiased {% if page.body_class %}{{ page.body_class }}{% endif %}"
        style="background-image: url('{{ background_image | relative_url }}');"
    >
        <header class="mx-auto mt-12 max-w-5xl px-6">
            <div
                class="flex flex-col gap-6 rounded-2xl border border-slate-200 bg-white/90 p-6 shadow-sm backdrop-blur-lg md:flex-row md:items-center md:justify-between"
            >
                <h1 class="font-display text-3xl font-semibold tracking-tight">
                    <a
                        href="{{ '/' | relative_url }}"
                        class="text-slate-900 transition hover:text-slate-600"
                        >ðŸ’­ Minji's Archive</a
                    >
                </h1>
                <nav class="flex flex-wrap gap-3 text-sm font-medium text-slate-600">
                    {% assign nav_base_class = 'rounded-full border border-transparent px-4 py-2 transition hover:border-slate-300 hover:bg-slate-100/80' %}
                    {% assign nav_active_class = 'border-slate-300  text-slate-900' %}
                    {% capture nav_active_attrs %} aria-current="page" style="--tw-bg-opacity: 0.8;"{% endcapture %}
                    {% assign normalized_home_url = site.baseurl | append: '/' %}
                    {% assign current_section = '' %}
                    {% if page.url == '/' or page.url == '/index.html' or page.url == site.baseurl or page.url == normalized_home_url %}
                        {% assign current_section = 'home' %}
                    {% elsif page.layout == 'post' or page.url contains '/devlog' %}
                        {% assign current_section = 'devlog' %}
                    {% elsif page.url contains '/portfolio' %}
                        {% assign current_section = 'portfolio' %}
                    {% elsif page.url contains '/about' %}
                        {% assign current_section = 'about' %}
                    {% endif %}
                    <a
                        href="{{ '/' | relative_url }}"
                        class="{{ nav_base_class }}{% if current_section == 'home' %} {{ nav_active_class }}{% endif %}"
                        {% if current_section == 'home' %}{{ nav_active_attrs }}{% endif %}
                    >
                        Home
                    </a>
                    <a
                        href="{{ '/devlog' | relative_url }}"
                        class="{{ nav_base_class }}{% if current_section == 'devlog' %} {{ nav_active_class }}{% endif %}"
                        {% if current_section == 'devlog' %}{{ nav_active_attrs }}{% endif %}
                    >
                        Dev Log
                    </a>
                    <a
                        href="{{ '/portfolio' | relative_url }}"
                        class="{{ nav_base_class }}{% if current_section == 'portfolio' %} {{ nav_active_class }}{% endif %}"
                        {% if current_section == 'portfolio' %}{{ nav_active_attrs }}{% endif %}
                    >
                        Portfolio
                    </a>
                    <a
                        href="{{ '/about' | relative_url }}"
                        class="{{ nav_base_class }}{% if current_section == 'about' %} {{ nav_active_class }}{% endif %}"
                        {% if current_section == 'about' %}{{ nav_active_attrs }}{% endif %}
                    >
                        About
                    </a>
                </nav>
            </div>
        </header>

        <main class="mx-auto mt-10 max-w-5xl px-6 pb-16">
            {{ content }}
        </main>

        <footer class="mx-auto max-w-5xl px-6 pb-12 text-sm text-slate-500">
            Â© {{ site.time | date: '%Y' }} Minji
        </footer>
        <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                if (window.mermaid) {
                    mermaid.initialize({
                        startOnLoad: true,
                        theme: 'base',
                        themeVariables: {
                            primaryColor: '#ffe4e6',
                            primaryBorderColor: '#fb7185',
                            primaryTextColor: '#0f172a',
                            lineColor: '#f472b6',
                            secondaryColor: '#fdf2f8',
                            tertiaryColor: '#e2e8f0',
                            background: '#ffffff',
                            fontFamily: 'Poppins, "Noto Sans KR", sans-serif'
                        }
                    });
                }
            });
        </script>
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                document.querySelectorAll('[data-series-filter-group]').forEach(function (container) {
                    var groupId = container.getAttribute('data-series-filter-group');
                    var targetList = document.querySelector('[data-series-list="' + groupId + '"]');
                    if (!targetList) {
                        return;
                    }
                    var buttons = Array.prototype.slice.call(container.querySelectorAll('[data-series-filter]'));
                    var cards = Array.prototype.slice.call(targetList.querySelectorAll('[data-series-card]'));

                    function applyFilter(target) {
                        buttons.forEach(function (btn) {
                            btn.classList.toggle('active', btn.getAttribute('data-series-filter') === target);
                            if (target === 'all') {
                                btn.classList.toggle('active', btn.getAttribute('data-series-filter') === 'all');
                            }
                        });
                        cards.forEach(function (card) {
                            var series = card.getAttribute('data-series') || 'none';
                            if (target === 'all' || target === series) {
                                card.classList.remove('hidden');
                            } else {
                                card.classList.add('hidden');
                            }
                        });
                    }

                    buttons.forEach(function (btn) {
                        btn.addEventListener('click', function () {
                            var target = btn.getAttribute('data-series-filter');
                            applyFilter(target);
                        });
                    });

                    if (buttons.length > 0) {
                        applyFilter('all');
                    }
                });
            });
        </script>
    </body>
</html>
